<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web Workeræµ‹è¯•</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-8">
    <div class="max-w-2xl mx-auto bg-white p-6 rounded-lg shadow-md">
        <h1 class="text-2xl font-bold mb-4">Web Workeræµ‹è¯•</h1>
        
        <div class="mb-6">
            <h2 class="text-xl font-semibold mb-2">æµ‹è¯•æ­¥éª¤ï¼š</h2>
            <ol class="list-decimal list-inside space-y-1">
                <li>æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰</li>
                <li>åˆ‡æ¢åˆ°"æ§åˆ¶å°"æ ‡ç­¾</li>
                <li>ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®æµ‹è¯•WorkeråŠŸèƒ½</li>
            </ol>
        </div>
        
        <div class="flex space-x-4">
            <button id="test-worker" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded">
                æµ‹è¯•Worker
            </button>
            <button id="terminate-worker" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded">
                ç»ˆæ­¢Worker
            </button>
        </div>
        
        <div id="status" class="mt-6 p-4 rounded bg-gray-50 min-h-[100px]">
            çŠ¶æ€ä¿¡æ¯å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ...
        </div>
    </div>

    <script>
        let worker = null;
        const statusDiv = document.getElementById('status');
        const testButton = document.getElementById('test-worker');
        const terminateButton = document.getElementById('terminate-worker');
        
        // æµ‹è¯•Worker
        testButton.addEventListener('click', function() {
            if (!worker) {
                try {
                    worker = new Worker('worker.js');
                    statusDiv.innerHTML += '<p class="text-green-600">âœ… Workeråˆ›å»ºæˆåŠŸ</p>';
                    
                    // ç›‘å¬Workeræ¶ˆæ¯
                    worker.addEventListener('message', function(e) {
                        statusDiv.innerHTML += `<p class="text-blue-600">ğŸ“© æ”¶åˆ°Workeræ¶ˆæ¯: ${JSON.stringify(e.data)}</p>`;
                    });
                    
                    // ç›‘å¬Workeré”™è¯¯
                    worker.addEventListener('error', function(error) {
                        statusDiv.innerHTML += `<p class="text-red-600">âŒ Workeré”™è¯¯: ${error.message} (è¡Œ: ${error.lineno})</p>`;
                    });
                } catch (error) {
                    statusDiv.innerHTML += `<p class="text-red-600">âŒ åˆ›å»ºWorkerå¤±è´¥: ${error.message}</p>`;
                }
            }
            
            // å‘é€æµ‹è¯•æ¶ˆæ¯
            if (worker) {
                statusDiv.innerHTML += '<p class="text-gray-600">ğŸ“¤ å‘é€æµ‹è¯•æ¶ˆæ¯ç»™Worker</p>';
                worker.postMessage({
                    action: 'test',
                    message: 'Hello from main thread!'
                });
            }
        });
        
        // ç»ˆæ­¢Worker
        terminateButton.addEventListener('click', function() {
            if (worker) {
                worker.terminate();
                worker = null;
                statusDiv.innerHTML += '<p class="text-orange-600">ğŸ›‘ Workerå·²ç»ˆæ­¢</p>';
            } else {
                statusDiv.innerHTML += '<p class="text-gray-600">â„¹ï¸ æ²¡æœ‰æ´»è·ƒçš„Worker</p>';
            }
        });
        
        // é¡µé¢åŠ è½½å®Œæˆ
        window.addEventListener('load', function() {
            statusDiv.innerHTML += '<p class="text-gray-600">â„¹ï¸ é¡µé¢åŠ è½½å®Œæˆï¼Œå‡†å¤‡æµ‹è¯•Worker</p>';
        });
    </script>
</body>
</html>
